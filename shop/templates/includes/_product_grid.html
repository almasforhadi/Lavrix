{% load static %}

<div class="row g-4">
  {% for product in products %}
  <div class="col-xl-4 col-md-6">
    <div class="card border-0 shadow-sm h-100 rounded-4 overflow-hidden position-relative"
         style="cursor: pointer;">

      <!-- Product Image -->
      <div class="position-relative">
      {% if product.images.all %}
      <a href="{% url 'shop:product_detail' product.slug %}">
        <img src="{{ product.images.first.image.url }}" alt="{{ product.name }}" class="card-img-top"
          style="height: 260px; object-fit: cover;">
      </a>
      {% else %}
      <a href="{% url 'shop:product_detail' product.slug %}">
        <img src="{% static 'images/no-image.jpg' %}" alt="No Image" class="card-img-top">
      </a>
      {% endif %}


        <!-- Hover Overlay -->
      <a href="{% url 'shop:product_detail' product.slug %}"
        class="overlay position-absolute top-0 start-0 w-100 h-100 d-flex align-items-center justify-content-center bg-dark bg-opacity-50 opacity-0 hover-opacity-100 transition text-decoration-none">
        <span class="btn btn-light btn-sm">View Details</span>
      </a>

      </div> 

      <!-- Product Info -->
      <div class="card-body text-center">
        <h6 class="fw-semibold">{{ product.name }}</h6>

        {% if product.sale_price %}
        <p class="mb-1">
          <span class="text-decoration-line-through text-muted">${{ product.price }}</span>
          <span class="text-danger fw-semibold ms-1">${{ product.sale_price }}</span>
        </p>
        {% else %}
        <p class="fw-semibold text-dark mb-1">${{ product.price }}</p>
        {% endif %}

        {% if request.user.is_authenticated %}
        <a href="#" class="btn btn-outline-dark btn-sm mt-2 btn-add-cart" data-id="{{ product.id }}">Add to Cart</a>
        {% else %}
        <button class="btn btn-outline-dark btn-sm mt-2 btn-show-login-modal">Add to Cart</button>
        {% endif %}





      </div>
    </div>
  </div>
  {% endfor %}
</div>



<!-- Pagination -->
<div class="mt-5 d-flex justify-content-center">
  <nav aria-label="Page navigation">
    <ul class="pagination pagination-lg mb-0">
      {% if products.has_previous %}
      <li class="page-item">
        <a class="page-link" href="?page={{ products.previous_page_number }}">«</a>
      </li>
      {% else %}
      <li class="page-item disabled"><a class="page-link">«</a></li>
      {% endif %}

      {% for num in products.paginator.page_range %}
      <li class="page-item {% if products.number == num %}active{% endif %}">
        <a class="page-link" href="?page={{ num }}">{{ num }}</a>
      </li>
      {% endfor %}

      {% if products.has_next %}
      <li class="page-item">
        <a class="page-link" href="?page={{ products.next_page_number }}">»</a>
      </li>
      {% else %}
      <li class="page-item disabled"><a class="page-link">»</a></li>
      {% endif %}
    </ul>
  </nav>
</div>

